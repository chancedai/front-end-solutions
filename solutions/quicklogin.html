<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<title>快速登录</title>
	<script src="http://i.sso.sina.com.cn/js/ssologin.js"></script>
	<style type="text/css">
		@-webkit-keyframes shake {0%, 100% {-webkit-transform: translateX(0);} 10%, 30%, 50%, 70%, 90% {-webkit-transform: translateX(-3px);} 20%, 40%, 60%, 80% {-webkit-transform: translateX(3px);} } @-moz-keyframes shake {0%, 100% {-moz-transform: translateX(0);} 10%, 30%, 50%, 70%, 90% {-moz-transform: translateX(-3px);} 20%, 40%, 60%, 80% {-moz-transform: translateX(3px);} } @-o-keyframes shake {0%, 100% {-o-transform: translateX(0);} 10%, 30%, 50%, 70%, 90% {-o-transform: translateX(-3px);} 20%, 40%, 60%, 80% {-o-transform: translateX(3px);} } @keyframes shake {0%, 100% {transform: translateX(0);} 10%, 30%, 50%, 70%, 90% {transform: translateX(-3px);} 20%, 40%, 60%, 80% {transform: translateX(3px);} }
		.demo-20150703155854 .shake {-webkit-animation: shake 1s; -moz-animation: shake 1s; -o-animation: shake 1s; animation: shake 1s; } .demo-20150703155854{width:800px;padding:20px;margin:0 auto;} .demo-20150703155854,.demo-20150703155854 button,.demo-20150703155854 input{font-family: "Microsoft Yahei", SimHei;font-size: 14px;} .demo-20150703155854 .clearfix:after{content:'.';display:block;height:0;clear:both;visibility: hidden;} .demo-20150703155854 .clearfix{*zoom:1;} .demo-20150703155854 p{margin:0;padding:0;} .demo-20150703155854 ul{list-style: none;padding:0;margin:0;} .demo-20150703155854 button{margin:0 5px 0 0;} .demo-20150703155854 .hd,.demo-20150703155854 .bd,.demo-20150703155854 .ft{background: #eee;margin:10px 0;padding:10px 10px 5px;border-top:1px solid #000;border-radius: 0 0 3px 3px;} .demo-20150703155854 .bd .action{padding:10px 0;text-align: right;} .demo-20150703155854 .bd textarea{width:683px;height:60px;} .demo-20150703155854 .tip{color:green;font-weight: bold;position: relative;} .demo-20150703155854 .layer{border:1px solid #ccc;padding:5px;margin:10px 0;} .demo-20150703155854 .layer li{padding:3px;} .demo-20150703155854 .layer .label{display: inline-block;width:70px;vertical-align: top;} .demo-20150703155854 .hd li{margin:0 0 10px 0;padding:5px;width:380px;float: left;display: inline;overflow: hidden;border-bottom: 1px solid #ccc;} .demo-20150703155854 .hd .desc{margin: 10px 0 0 0;padding:5px;font-size: 12px;background: #ddd;color:#333;} .demo-20150703155854 .hd .name{font-size: 12px;} .demo-20150703155854 .ft{color:red;padding:10px;} </style>
</head>
<body>
	<div id="demo_20150703155854" class="demo-20150703155854"> <ul class="hd clearfix" node-type="list"></ul> <div class="bd"> <button node-type="addPop">添加账号</button> <button node-type="logout">退出</button> <span class="tip" node-type="tip"></span> <div class="layer" node-type="layer" style="display:none;"> <ul> <li> <label> <span class="label">用户名：</span> <input type="text" node-type="name"></label> </li> <li> <label> <span class="label">密码：</span> <input type="password" node-type="pwd"></label> </li> <li> <label> <span class="label">描述:</span> <textarea node-type="desc"></textarea> </label> </li> </ul> <p class="action"> <button node-type="add">确定</button> </p> </div> </div> <div class="ft">注意：问题账号登录后，可能需要验证码；用户信息保存在本地存储，清除后需重新添加，使用时请注意安全！！！</div> </div>
	<script src="http://news.sina.com.cn/js/792/2014-03-18/80/jquery-1.11.0.min.js"></script>
	<script type="text/javascript"> (function(window) {var getNodes = function(wrap, attr) {attr = attr || 'node-type'; wrap = $(wrap); var nodes = $("[" + attr + "]", wrap); var nodesObj = {}; nodesObj.wrap = wrap; nodes.each(function(i) {var item = $(this); nodesObj[item.attr(attr)] = item; }); return nodesObj; }; var LStorage = (function() {var localStorageName = 'localStorage', isLocalStorageNameSupported = function() {try {return ((localStorageName in window) && window[localStorageName]); } catch (err) {return false; } }, lStorage = {set: function() {}, get: function() {return ''; } }; if (isLocalStorageNameSupported() && window['JSON']) {lStorage = {set: function(key, val) {val = JSON.stringify(val); try {localStorage.setItem(key, val); } catch (e) {} }, get: function(key) {var val = localStorage.getItem(key); return JSON.parse(val); } }; } return lStorage; })(); var Controller = (function() {window.QUICK_LOGIN = (function() {var SC = new SSOController(); SC.init(); SC.name = "QUICK_LOGIN"; SC.entry = "sso"; SC.domain = "sina.com.cn"; SC.setDomain = true; SC.customLoginCallBack = function(loginStatus) {Tip.done('登录成功!'); }; SC.customLogoutCallBack = function(result) {Tip.done('退出成功!'); }; return SC; })(); var ATTR = 'node-type'; var getSelector = function(name) {return '[' + ATTR + '=' + name + ']'; }; var LSNAME = 'quicklogindata'; var dom = getNodes('#demo_20150703155854', ATTR); var Tip = (function() {var tip = dom.tip; var clz = 'shake'; return {doing: function(txt) {tip.removeClass(clz); tip.html(txt); }, done: function(txt) {tip.addClass(clz); tip.html(txt); } }; })(); var defaultData = {'testnn009@sina.com': {name: 'testnn009@sina.com', pwd: '123123', desc: '有微博'}, 'testnn9@sina.com': {name: 'testnn9@sina.com', pwd: '123123', desc: '无微博'}, 'd340433246@sina.cn': {name: 'd340433246@sina.cn', pwd: 'd340433246', desc: '全新'}, 'qina5277': {name: 'qina5277', pwd: 'keainami', desc: 'feed流测试'} }; var data; var getItemHtml = function() {var self = this; var del = self.custom ? '<button class="remove" node-type="remove" user-name="' + self.name + '">删除</button>' : ''; return '<li><button class="login" user-name="' + self.name + '" node-type="login">登录</button>' + del + '<span class="name">' + self.name + '</span><p class="desc">' + self.desc + '</p></li>'; }; var listRender = function() {data = $.extend(defaultData, LStorage.get(LSNAME)); LStorage.set(LSNAME, data); var html = []; for (var name in data) {if (data[name]) {html.push(getItemHtml.call(data[name])); } } dom.list.html(html.join('')); }; var add = function(name, pwd, desc) {var item = {name: name, pwd: pwd, desc: desc, custom: true }; if (data[name]) {return; } data[name] = item; LStorage.set(LSNAME, data); dom.list.append(getItemHtml.call(item)); dom.name.val(); dom.pwd.val(); dom.desc.val(); dom.layer.hide(); }; var remove = function(btn) {var name = btn.attr('user-name'); delete data[name]; LStorage.set(LSNAME, data); btn.parents('li').remove(); }; var login = function(name) {var item = data[name]; Tip.doing('登录中...'); QUICK_LOGIN.login(item.name, item.pwd, 30); }; var logout = function() {Tip.doing('退出中...'); QUICK_LOGIN.logout(); }; var bind = function() {dom.wrap.on('click', getSelector('addPop'), function() {dom.layer.toggle(); }); dom.wrap.on('click', getSelector('add'), function() {add(dom.name.val(), dom.pwd.val(), dom.desc.val()); }); dom.wrap.on('click', getSelector('remove'), function() {var btn = $(this); remove(btn); }); dom.wrap.on('click', getSelector('login'), function() {var btn = $(this); var name = btn.attr('user-name'); login(name); }); dom.wrap.on('click', getSelector('logout'), function() {logout(); }); }; return {init: function() {listRender(); bind(); } }; })(); Controller.init(); })(window); </script>
</body>
</html>