(function(){var t=window;var e=document;var i=e.documentElement;var r=/top|middle|bottom/;var o=/left|center|right/;var s=/%$/;var n={left:"right",center:"center",right:"left",top:"bottom",middle:"middle",bottom:"top"};var f=function(t,e){if(e.indexOf){return e.indexOf(t)}var i=0,r=e.length;while(i<r){if(e[i]===t){return i}i++}return-1};function l(i){if(typeof i==="string"){if(i==="window"){i=t}else if(i==="document"){i=e}}return i}function h(t){var e=t.split(" ");return{y:r.test(e[0])?e[0]:"top",x:o.test(e[1])?e[1]:"left"}}function a(t,e){if(t===e){return true}if(!t||!e){return false}return t.top===e.top&&t.left===e.left&&t.height===e.height&&t.width===e.width}function u(t){var e=t[0];if(e.nodeType===9){return{width:t.outerWidth(),height:t.outerHeight(),top:0,left:0}}if($.isWindow(e)){return{width:t.outerWidth(),height:t.outerHeight(),top:t.scrollTop(),left:t.scrollLeft()}}if(e.preventDefault){return{width:0,height:0,top:e.pageY,left:e.pageX}}var i=t.offset();return{width:t.outerWidth(),height:t.outerHeight(),top:i.top,left:i.left}}function c(t,e){var i=t[0];if(i.nodeType===9){return}if($.isWindow(i)){e.top=t.scrollTop();e.left=t.scrollLeft()}if(i.preventDefault){e.top=i.pageY;e.left=i.pageX;return}var r=t.offset();e.top=r.top;e.left=r.left;return}function d(t){var e=t[0];var r;if(e.nodeType===9){e=i;r={top:0,left:0}}else if($.isWindow(e)){e=i;r={top:t.scrollTop(),left:t.scrollLeft()}}else{r=t.offset()}return{width:e.clientWidth,height:e.clientHeight,top:r.top+e.clientTop,left:r.left+e.clientLeft}}function p(t,e){var r=t[0];var o;if(r.nodeType===9){r=i;o={top:0,left:0}}else if($.isWindow(r)){r=i;o={top:t.scrollTop(),left:t.scrollLeft()}}else{o=t.offset()}e.top=o.top+r.clientTop;e.left=o.left+r.clientLeft;return}function g(t,e){return{y:parseFloat(t.y)*(s.test(t.y)?e.height/100:1),x:parseFloat(t.x)*(s.test(t.x)?e.width/100:1),mirror:t.mirror}}function m(t,e,i){var r={top:0,left:0,middle:t.height*.5,center:t.width*.5,bottom:t.height,right:t.width};if(e.y!==0){r.middle+=e.y;if(e.mirror){r.top+="top"!==i.y?e.y*-1:e.y;r.bottom+="bottom"!==i.y?e.y*-1:e.y}else{r.top+=e.y;r.bottom+=e.y}}if(e.x!==0){r.center+=e.x;if(e.mirror){r.left+="left"!==i.x?e.x*-1:e.x;r.right+="right"!==i.x?e.x*-1:e.x}else{r.left+=e.x;r.right+=e.x}}return r}function y(t){var e=[];t.top>0&&e.push("top");t.left>0&&e.push("left");t.bottom<0&&e.push("bottom");t.right<0&&e.push("right");if(e.length){t.overflow=e}else{t.overflow=null}return t}function v(t,e){var i={top:t.top-e.top,left:t.left-e.left,bottom:t.top+t.height-(e.top+e.height),right:t.left+t.width-(e.left+e.width),overflow:[]};return y(i)}function x(t,e,i,r){var o,s,l;var h={y:e.y,x:e.x};var a={y:i.y,x:i.x};if(f("top",r.overflow)!==-1){o="top"}if(f("bottom",r.overflow)!==-1){if(o){o=null}else{o="bottom"}}if(f("left",r.overflow)!==-1){s="left"}if(f("right",r.overflow)!==-1){if(s){s=null}else{s="right"}}if(!o&&!s){return null}t=t===true?"both":t;l=0;switch(t){case"item":l=1;break;case"target":l=2;break;case"both":l=3;break}if(l&1){o&&(h.y=n[h.y]);s&&(h.x=n[h.x])}if(l&2){o&&(a.y=n[a.y]);s&&(a.x=n[a.x])}return{item_at:h,tar_at:a}}function w(t,e,i){var r,o,s,n,f;if(i){f=["top","bottom"]}else{f=["left","right"]}r=t[f[0]];s=e[f[0]];o=t[f[1]]*-1;n=e[f[1]]*-1;r<0&&(r=0);o<0&&(o=0);s<0&&(s=0);n<0&&(n=0);if(r<0&&o<0){return true}if(s<0&&n<0){return false}return r+o<s+n}function b(t,e){if(e==="all"){e=true}var i=t.distance.overflow;if(!i.length){return t}var r=false;var o=false;var s,n;for(var f=i.length-1;f>=0;f--){s=i[f];switch(s){case"top":case"bottom":if(!o&&e===true||e.indexOf(s)!==-1){n=t.distance[s];t.moveBy.y+=n;t.distance.top-=n;t.distance.bottom-=n;o=true}break;case"left":case"right":if(!r&&e===true||e.indexOf(s)!==-1){n=t.distance[s];t.moveBy.x+=n;t.distance.left-=n;t.distance.right-=n;r=true}break}}y(t.distance);return t}function P(t){if(!(this instanceof P)){return new P(t)}this.options=this.$itm=this.$trg=this.$bnd=this.itmAt=this.trgAt=this.itmPos=this.trgPos=this.bndPos=this.itmOffset=this.trgOffset=null;this._init(t)}P.prototype._init=function(t){var e=this.options=$.extend({},P.defaults,t);if(!e.item){return null}this.$itm=e.item.jquery?e.item:$(e.item);if(this.$itm.length===0){return null}this.$trg=e.target&&e.target.jquery?e.target:$(l(e.target));this.$bnd=e.boundary&&e.boundary.jquery?e.boundary:$(l(e.boundary));this.itmAt=h(e.itemAt);this.trgAt=h(e.targetAt);this.resize();return this};P.prototype.resize=function(){var t=this.options;var e=u(this.$itm);var i=this.$trg.length?u(this.$trg):null;this.bndPos=this.$bnd.length?d(this.$bnd):null;if(!this.itmPos||!a(e,this.itmPos)){this.itmPos=e;var r=g(t.itemOffset,e);r.x=r.x*-1;r.y=r.y*-1;this.itmOffset=m(e,r,this.itmAt)}if(!this.trgPos||!a(i,this.trgPos)){this.trgPos=i;if(i){this.trgOffset=m(i,g(t.targetOffset,i),this.trgAt)}}return this};P.prototype.calcVariant=function(t,e){var i={moveBy:null,distance:null,itemAt:null,targetAt:null};if(this.trgPos&&t&&e){var r={top:this.trgPos.top+this.trgOffset[e.y],left:this.trgPos.left+this.trgOffset[e.x]};var o={top:r.top-this.itmOffset[t.y],left:r.left-this.itmOffset[t.x],height:this.itmPos.height,width:this.itmPos.width};i.moveBy={y:o.top-this.itmPos.top,x:o.left-this.itmPos.left};i.distance=this.bndPos?v(this.bndPos,o):null;i.itemAt=t.y+" "+t.x;i.targetAt=e.y+" "+e.x}else{i.moveBy={y:0,x:0};i.distance=this.bndPos?v(this.bndPos,this.itmPos):null}return i};P.prototype.calculate=function(){if(this.itmPos===null){return null}var t=this.options;c(this.$itm,this.itmPos);this.trgPos&&c(this.$trg,this.trgPos);this.bndPos&&p(this.$bnd,this.bndPos);var e=this.calcVariant(this.itmAt,this.trgAt);if(!e.distance||!e.distance.overflow){return e}if(t.flip&&t.flip!=="none"&&this.trgPos){var i;var r=x(t.flip,this.itmAt,this.trgAt,e.distance);if(r){i=this.calcVariant(r.item_at,r.tar_at);if(!i.distance.overflow){return i}var o={y:false,x:false};o.y=w(i.distance,e.distance,true);o.x=w(i.distance,e.distance,false);if(o.y!==o.x){e=this.calcVariant({y:o.y?r.item_at.y:this.itmAt.y,x:o.x?r.item_at.x:this.itmAt.x},{y:o.y?r.tar_at.y:this.trgAt.y,x:o.x?r.tar_at.x:this.trgAt.x});if(!e.distance.overflow){return e}}else if(o.y&&o.x){e=i}}}if(t.stick&&t.stick!=="none"){return b(e,t.stick)}else{return e}};P.defaults={item:null,target:null,boundary:window,itemAt:"top left",targetAt:"top left",itemOffset:{y:0,x:0,mirror:true},targetOffset:{y:0,x:0,mirror:true},flip:"none",stick:"none"};window.PositionCalculator=P})();