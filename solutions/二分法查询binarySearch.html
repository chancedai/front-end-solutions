<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
</head>
<body>
    <script type="text/javascript">
        Array.prototype.binarySearch = function(obj) {
            var value = 0;
            var left = 0;
            var right = this.length;
            while (left <= right) {
                var center = Math.floor((left + right) / 2);
                if (this[center] == obj) {
                    value = center;
                }
                if (obj < this[center]) {
                    right = center - 1;
                } else {
                    left = center + 1;
                }
            }
            return value;
        }

        function binarySearch(items, value) {
            var startIndex = 0,
                stopIndex = items.length - 1,
                middle = Math.floor((stopIndex + startIndex) / 2);
            while (items[middle] != value && startIndex < stopIndex) {
                //adjust search area（调整查找范围）
                if (value < items[middle]) {
                    stopIndex = middle - 1;
                } else if (value > items[middle]) {
                    startIndex = middle + 1;
                }
                //recalculate middle（重新计算中项索引）
                middle = Math.floor((stopIndex + startIndex) / 2);
            }
            //make sure it's the right value（确保返回正确的值）
            return (items[middle] != value) ? -1 : middle;
        }
        var binarySearch = function(targetElement, array, compareFunction) {
            var compareResult, element, high, low, middle;
            high = array.length - 1;
            low = 0;
            while (low <= high) {
                middle = Math.floor((low + high) / 2);
                element = array[middle];
                compareResult = compareFunction(element, targetElement);
                if (compareResult > 0) {
                    high = middle - 1;
                } else if (compareResult < 0) {
                    low = middle + 1;
                } else {
                    return middle;
                }
            }
            if (compareFunction(element, targetElement) < 0) {
                return middle + 1;
            } else {
                return middle;
            }
        };
         //如下为测试代码：
        function testArrayBinarySearch() {
            var array = new Array();
            var key = 678;
            var number = 1000;
            for (i = 0; i < number; i++) {
                array.push(i);
            }
            console.log(array.binarySearch(key));
            console.log(binarySearch(array,key));

        }
        window.onload = function() {
            testArrayBinarySearch();
        }
    </script>
</body>
</html>